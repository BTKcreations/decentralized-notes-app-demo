<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlockNotes v2 (P2P + Encrypted)</title>
    <!-- PeerJS CDN -->
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">

        <!-- LOGIN VIEW -->
        <section id="login-view" class="view-section">
            <header>
                <h1>BlockNotes <span class="badge">v2</span></h1>
                <p>Decentralized, Encrypted, Peer-to-Peer Notes</p>
            </header>
            <div class="login-card">
                <h2><i class="fas fa-key"></i> Identify Yourself</h2>

                <div class="tabs">
                    <button class="tab-btn active" onclick="App.switchLoginTab('login')">Login</button>
                    <button class="tab-btn" onclick="App.switchLoginTab('create')">New Wallet</button>
                </div>

                <div id="login-tab-content">
                    <p class="hint">Enter your 12-word Seed Phrase to restore your keys.</p>
                    <textarea id="seedPhraseInput" placeholder="apple river sky ..."></textarea>
                    <button id="loginBtn" class="primary-btn">Unlock Wallet</button>
                </div>

                <div id="create-tab-content" style="display: none;">
                    <p class="hint">Save these words safely! They are your ONLY way to access this account.</p>
                    <div id="newSeedDisplay" class="seed-box"></div>
                    <button id="createWalletBtn" class="secondary-btn">I Have Saved Them</button>
                </div>
            </div>
        </section>

        <!-- P2P CONNECTION PANEL (GLOBAL) -->
        <div id="p2p-panel" class="p2p-panel collapsed">
            <div class="p2p-header" onclick="document.getElementById('p2p-panel').classList.toggle('collapsed');">
                <span><i class="fas fa-network-wired"></i> P2P Connection Manager <small>(Sync before
                        Login)</small></span>
                <button id="toggleP2P" class="icon-btn"><i class="fas fa-chevron-down"></i></button>
            </div>
            <div class="p2p-content">
                <div class="my-peer-id">
                    <label>Your Peer ID (Share this):</label>
                    <div class="copy-row">
                        <input type="text" id="myPeerId" readonly>
                        <button id="copyPeerBtn"><i class="fas fa-copy"></i></button>
                    </div>
                </div>
                <div class="connect-peer">
                    <label>Connect to Friend:</label>
                    <div class="connect-row">
                        <input type="text" id="peerIdInput" placeholder="Friend's Peer ID">
                        <button id="connectPeerBtn" class="secondary-btn">Connect</button>
                    </div>
                </div>
                <div class="peer-list">
                    <h4>Connected Peers:</h4>
                    <ul id="connectedPeersList"></ul>
                </div>
            </div>
        </div>

        <!-- DASHBOARD VIEW -->
        <section id="dashboard-view" class="view-section" style="display: none;">
            <header class="dashboard-header">
                <div class="logo">BlockNotes <span class="badge">v2</span></div>

                <div class="network-status" id="networkStatus">
                    <i class="fas fa-satellite-dish"></i>
                    <span id="connectionCount">Offline</span>
                </div>

                <div class="user-info">
                    <i class="fas fa-user-shield"></i>
                    <code id="myAddressDisplay">My Wallet Active</code>
                    <button id="copyPublicKeyBtn" class="icon-btn" title="Copy Public Key for Receiving Notes"><i
                            class="fas fa-key"></i></button>
                    <button id="logoutBtn" class="text-btn"> <i class="fas fa-sign-out-alt"></i> </button>
                </div>
            </header>

            <!-- Network Helper Panel MOVED UP -->

            <main class="dashboard-grid">
                <!-- Create Note Panel -->
                <div class="create-panel">
                    <h2><i class="fas fa-pen-fancy"></i> New Secure Note</h2>
                    <input type="text" id="recipientInput" placeholder="Recipient Public Key (Empty for Self-Note)">
                    <textarea id="noteContent"
                        placeholder="Write your secret note here... (It will be Encrypted)"></textarea>
                    <button id="sendNoteBtn" class="primary-btn"><i class="fas fa-cube"></i> Encrypt & Mine</button>
                </div>

                <!-- Notes Feed -->
                <div class="feed-panel">
                    <h2>My Chain Feed</h2>
                    <div id="notesContainer" class="notes-list">
                        <!-- Notes will appear here -->
                    </div>
                </div>
            </main>
        </section>

    </div>
    <script src="script.js"></script>
</body>

</html>